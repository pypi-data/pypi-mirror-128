!function(a,t){"use strict";function e(a){let t=window;for(let e of a.split("."))if(t=t[e],void 0===t)throw"Cannot locate map factory: "+a;return t}let r={tile_layer:function(a,t){a.layer_created(new L.TileLayer(t.urlTemplate,t.options),t)},geo_json:function(a,e){t.getJSON(e.dataUrl,(function(t){a.layer_created(new L.GeoJSON(t,e.options),e)}))}};class i{static initialize(a){t("div.cone-map",a).each((function(){let a=t(this);new(e(a.data("map-factory")))(a)}))}constructor(a){this.elem=a,this.id=a.attr("id"),this.layers=a.data("map-layers"),this.default_center=a.data("map-center"),this.default_zoom=a.data("map-zoom"),this.map_options=a.data("map-options"),this.control_options=a.data("map-control-options"),this.markers=a.data("data-map-markers"),this.markers_source=a.data("data-map-markers-source"),this.marker_groups=a.data("data-map-groups"),this.marker_groups_source=a.data("data-map-groups-source"),this.create(),a.data("map-instance",this)}create(){this.create_map(),this.create_controls(),this.create_layers()}create_map(){this.map=new L.Map(this.id,this.map_options),this.map.setView(this.default_center,this.default_zoom)}create_controls(){this.map_layers=new L.control.Layers([],[],this.control_options),this.map_layers.addTo(this.map)}create_layers(){for(let a of this.layers)r[a.factory](this,a)}layer_created(a,t){t.layer=a,(void 0===t.display||t.display)&&this.add_layer(a),"base"===t.category?this.map_layers.addBaseLayer(a,t.title):"overlay"===t.category&&this.map_layers.addOverlay(a,t.title)}add_layer(a){this.map.addLayer(a)}remove_layer(a){this.map.removeLayer(a)}}t((function(){void 0!==window.ts?ts.ajax.register(i.initialize,!0):bdajax.register(i.initialize,!0)})),a.Map=i,a.layer_factories=r,a.lookup_factory=e,Object.defineProperty(a,"__esModule",{value:!0}),window.cone_maps=a}({},jQuery);
